"use strict";(self.webpackChunkReportGeneration=self.webpackChunkReportGeneration||[]).push([[357],{3075:(k,f,r)=>{r.d(f,{F:()=>_});var u=r(4438),e=r(3464);let _=(()=>{class c{constructor(p){this.apiService=p,this.url="/hosts"}getHostsList(){return this.apiService.get(this.url+"/get_all_hosts")}getAllActiveHostsList(){return this.apiService.get(this.url+"/get_active_hosts")}getHostData(p){return this.apiService.get(this.url+"/get_host/"+p)}addHosts(p){return this.apiService.post(this.url+"/add_host",p)}editHosts(p){return this.apiService.put(this.url+"/update_host/"+p.id,p)}static{this.\u0275fac=function(g){return new(g||c)(u.KVO(e.G))}}static{this.\u0275prov=u.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})()},8357:(k,f,r)=>{r.r(f),r.d(f,{ScanFilesDetailsRoutingModule:()=>Z});var u=r(4937),e=r(4438);let _=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-scan-files-details"]],standalone:!0,features:[e.aNF],decls:1,vars:0,template:function(s,i){1&s&&e.nrm(0,"router-outlet")},dependencies:[u.n3]})}}return n})();var c=r(5447),v=r(1413),p=r(6977),g=r(980),F=r(1699),b=r(6689),R=r(6354),x=r(9437),D=r(3464);let S=(()=>{class n{constructor(t){this.apiService=t,this.url="/pii-scan"}getAllScanDataList(t){let s=this.url+"/scan_list";return s+="?offset="+(t.offset?t.offset:0),s+="&pageSize="+(t.pageSize?t.pageSize:""),s+="&field="+(t.field?t.field:""),s+="&sort="+(t.sort?t.sort:0),s+="&search"+(t.searchText?t.searchText:""),this.apiService.get(s).pipe((0,R.T)(i=>i),(0,x.W)(i=>this.apiService.handleError(i)))}addRemoteScanData(t){return this.apiService.post(this.url+"/remote-scan",t)}exportScanResults(t){return this.apiService.downloadFile(this.url+"/export-pii-results/"+t)}static{this.\u0275fac=function(s){return new(s||n)(e.KVO(D.G))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var j=r(1530),E=r(720),h=r(177),o=r(9417),C=r(8323),P=r(8278);function T(n,l){1&n&&(e.j41(0,"button",24),e.nrm(1,"img",25),e.k0s())}function N(n,l){if(1&n&&(e.j41(0,"tr")(1,"td",35),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(3);e.R7$(2),e.SpI("",t.isLoading?"Please wait while loading..":"No data found.."," ")}}function I(n,l){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",36),e.EFF(4),e.k0s(),e.j41(5,"td",37),e.EFF(6),e.k0s(),e.j41(7,"td",37),e.EFF(8),e.k0s(),e.j41(9,"td",37),e.EFF(10),e.k0s()()),2&n){const t=l.$implicit,s=l.index;e.R7$(2),e.JRh(s+1),e.R7$(2),e.JRh(t.piiType),e.R7$(2),e.JRh(t.filePath),e.R7$(2),e.JRh(t.matchedData),e.R7$(2),e.JRh(t.ip)}}function y(n,l){if(1&n&&(e.j41(0,"table",33)(1,"thead")(2,"tr")(3,"th"),e.EFF(4,"S.No."),e.k0s(),e.j41(5,"th"),e.EFF(6,"PII Type"),e.k0s(),e.j41(7,"th"),e.EFF(8,"File Name"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Match Data"),e.k0s(),e.j41(11,"th"),e.EFF(12,"IP Address"),e.k0s()()(),e.j41(13,"tbody"),e.DNE(14,N,3,1,"tr",34)(15,I,11,5,"tr",22),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(14),e.Y8G("ngIf",(null==t?null:t.piiScanResults)&&0===(null==t?null:t.piiScanResults.length)),e.R7$(),e.Y8G("ngForOf",t.piiScanResults)}}function L(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"div",26),e.bIt("click",function(){const i=e.eBV(t).index,a=e.XpG();return e.Njj(a.toggleBox(i))}),e.j41(2,"div",27),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(),d=e.sdS(28);return e.Njj(a.open(d,i.requestId,"xl"))}),e.j41(3,"p",28),e.EFF(4),e.j41(5,"span",29),e.EFF(6),e.k0s(),e.j41(7,"span",29),e.EFF(8),e.nI1(9,"dateTimeFormat"),e.k0s()()(),e.j41(10,"div")(11,"img",30),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.downloadScanResults(i.requestId))}),e.k0s(),e.nrm(12,"i",31),e.k0s()(),e.DNE(13,y,16,2,"table",32),e.k0s()}if(2&n){const t=l.$implicit,s=l.index,i=e.XpG();e.R7$(4),e.SpI("",t.targetName," "),e.R7$(2),e.SpI(" ",t.filePath," "),e.R7$(2),e.SpI(" ",e.i5U(9,5,t.createdDate,"time")," "),e.R7$(4),e.Y8G("ngClass",i.accordionVisibility[s]?"fas fa-chevron-up mx-3":"fas fa-chevron-down mx-3"),e.R7$(),e.Y8G("ngIf",i.accordionVisibility[s])}}function A(n,l){if(1&n&&(e.j41(0,"option",48),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function V(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",38)(1,"div",39)(2,"div",7)(3,"select",40),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.paginationRequest.pageSize,i)||(a.paginationRequest.pageSize=i),e.Njj(i)}),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onPageLimitChange(i))}),e.j41(4,"option",41),e.EFF(5,"Select"),e.k0s(),e.DNE(6,A,2,2,"option",42),e.k0s(),e.j41(7,"label",43),e.EFF(8,"Page Length"),e.k0s()()(),e.j41(9,"div",44)(10,"div",7)(11,"label",45),e.EFF(12),e.nrm(13,"br"),e.k0s(),e.nrm(14,"br"),e.k0s()(),e.j41(15,"div",46)(16,"div",7)(17,"app-custom-pagination",47),e.mxI("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.page,i)||(a.page=i),e.Njj(i)}),e.bIt("pageChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onPageChange(i))}),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(3),e.R50("ngModel",t.paginationRequest.pageSize),e.R7$(3),e.Y8G("ngForOf",t.pageLimits),e.R7$(6),e.SpI(" Total Records: ",t.totalResult,""),e.R7$(5),e.Y8G("collectionSize",t.totalResult),e.R50("page",t.page),e.Y8G("pageSize",t.paginationRequest.pageSize)}}function w(n,l){if(1&n&&(e.j41(0,"span",61),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.R7$(),e.JRh(t)}}function G(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",49)(1,"h4",50),e.EFF(2,"Scan Request Details"),e.k0s(),e.j41(3,"button",51),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",52)(5,"div",53)(6,"div",54),e.EFF(7,"File Path / Name"),e.k0s(),e.j41(8,"div",55),e.EFF(9,":"),e.k0s(),e.j41(10,"div",56),e.EFF(11),e.k0s()(),e.j41(12,"div",53)(13,"div",54),e.EFF(14,"Max File Size"),e.k0s(),e.j41(15,"div",55),e.EFF(16,":"),e.k0s(),e.j41(17,"div",56),e.EFF(18),e.k0s()(),e.j41(19,"div",53)(20,"div",54),e.EFF(21,"Pii Type"),e.k0s(),e.j41(22,"div",55),e.EFF(23,":"),e.k0s(),e.j41(24,"div",57),e.DNE(25,w,2,1,"span",58),e.k0s()(),e.j41(26,"div",53)(27,"div",54),e.EFF(28,"Exclude Patterns"),e.k0s(),e.j41(29,"div",55),e.EFF(30,":"),e.k0s(),e.j41(31,"div",56),e.EFF(32),e.k0s()(),e.j41(33,"div",53)(34,"div",54),e.EFF(35,"Created Date"),e.k0s(),e.j41(36,"div",55),e.EFF(37,":"),e.k0s(),e.j41(38,"div",56),e.EFF(39),e.nI1(40,"date"),e.k0s()()(),e.j41(41,"div",59)(42,"button",60),e.bIt("click",function(){const i=e.eBV(t).$implicit;return e.Njj(i.dismiss())}),e.EFF(43," close "),e.k0s()()}if(2&n){let t,s,i;const a=e.XpG();e.R7$(11),e.JRh(null!==(t=null==a.requestDetails?null:a.requestDetails.filePath)&&void 0!==t?t:"Not specified"),e.R7$(7),e.JRh(null!==(s=null==a.requestDetails?null:a.requestDetails.maxFileSize)&&void 0!==s?s:"10 MB (default)"),e.R7$(7),e.Y8G("ngForOf",a.getPiiTypes()),e.R7$(7),e.JRh(null!==(i=null==a.requestDetails?null:a.requestDetails.excludePatterns)&&void 0!==i?i:"Default patterns applied"),e.R7$(7),e.JRh(e.i5U(40,5,null==a.requestDetails?null:a.requestDetails.createdDate,"medium"))}}let $=(()=>{class n{constructor(t,s,i,a,d,m){this.globalService=t,this.filesScanService=s,this.spinner=i,this.modalService=a,this.router=d,this.cdr=m,this.showSort=!0,this.accordionVisibility=[],this.currentIndex=0,this.showError=!1,this.isLoading=!1,this.closeResult="",this.destroy$=new v.B,this.Is_EMPLOYEE=this.globalService.Is_EMPLOYEE,this.scanDataList=[],this.paginationRequest={},this.paginationResponseData={},this.pageLimits=this.globalService.getPageLimits()}ngOnInit(){this.getFileScanDataList(),this.reset(),this.scanDataList&&this.scanDataList.length>0&&(this.accordionVisibility=this.scanDataList.map((t,s)=>0===s))}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}toggleBox(t){if(this.accordionVisibility[t]){const s=(t+1)%this.accordionVisibility.length;this.accordionVisibility=this.accordionVisibility.map((i,a)=>a===s),this.currentIndex=s}else this.accordionVisibility=this.accordionVisibility.map((s,i)=>i===t),this.currentIndex=t}openAllAccordions(){this.accordionVisibility=this.scanDataList.map(()=>!0)}reset(){this.order="DESC",this.currentSort="filePath",this.paginationRequest={},this.page=1,this.totalResult=10,this.paginationRequest.offset=0,this.paginationRequest.pageSize=10,this.paginationRequest.sort=1,this.paginationRequest.field="createdDate",this.paginationRequest.searchText="",this.searchText="",this.getFileScanDataList()}onPageChange(t){Number(t)&&(this.paginationRequest.offset=+t-1,this.getFileScanDataList())}onPageLimitChange(t){let s;s=t.target.value,this.paginationRequest.pageSize=+s,this.resetPageNumber(),this.getFileScanDataList()}resetPageNumber(){this.page=1,this.paginationRequest.offset=0}searchMatchedData(){this.resetPageNumber(),this.destroy$.next(!0),this.getFileScanDataList()}getFileScanDataList(){this.isLoading=!0,this.spinner.start(),this.filesScanService.getAllScanDataList(this.paginationRequest).pipe((0,p.Q)(this.destroy$),(0,g.j)(()=>{this.isLoading=!1,this.spinner.stop()})).subscribe({next:t=>{this.paginationResponseData=t,this.totalResult=this.paginationResponseData?.response?.totalElements,this.scanDataList=t?.response?.content,this.accordionVisibility=this.searchText?.trim().length>0?this.scanDataList.map(()=>!0):this.scanDataList.map((i,a)=>0===a),this.cdr.detectChanges()},error:t=>console.error(t),complete:()=>console.info("complete")})}open(t,s,i){const a=this.scanDataList.find(d=>d.requestId===s);a?(this.requestDetails=a,this.modalService.open(t,{ariaLabelledBy:"modal-basic-title",size:i}).result.then(d=>{this.closeResult=`Closed with: ${d}`},d=>{this.closeResult=`Dismissed ${this.getDismissReason(d)}`})):console.error("Scan data not found for requestId:",s)}getDismissReason(t){return t===c.PQ.ESC?"by pressing ESC":t===c.PQ.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${t}`}getPiiTypes(){const t=this.requestDetails?.piiTypes;if(!t||"all"===t||Array.isArray(t)&&t.includes("all"))return["all (default)"];if("string"==typeof t)try{const s=JSON.parse(t);return Array.isArray(s)?s:t.split(",").map(i=>i.trim())}catch{return t.split(",").map(s=>s.trim())}return Array.isArray(t)?t:[]}scanFiles(){this.router.navigate(["jrm/scan-files-details/files_scan"])}downloadScanResults(t){this.filesScanService.exportScanResults(t).subscribe({next:s=>{this.globalService.downloadFileCommon(s,"xlsx","pii-scan-results","blob")},error:s=>{console.error("Export failed:",s)}})}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(b.d),e.rXU(S),e.rXU(j.eD),e.rXU(c.Bq),e.rXU(u.Ix),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-scan-files-details-list"]],standalone:!0,features:[e.aNF],decls:29,vars:8,consts:[["content",""],[1,"content-cand"],[1,"container-bg"],[1,"row","m-b-10","m-0"],[1,"search-section","template-filter-section"],[1,"template-filter-left-section"],[1,"template-sub-section"],[1,"floating-label-group"],["type","text","required","",1,"form-control",3,"ngModelChange","keyup","ngModel"],["for","search",1,"floating-label"],[1,"input-group-append","showCursor"],["ngbPopover","Search with File Name and PII Type","placement","bottom","popoverClass","textboxPopoverCls",1,"fas","fa-info-circle","fontawsome-icon",3,"autoClose"],[1,"template-filter-right-section"],["ngbTooltip","Reset Filters",1,"btn","btn-reset",3,"click"],["src","assets/images/icons/reset.svg",1,"icons_default_size"],["ngbTooltip","Click to scan folders or directories",1,"btn","btn-add-users",3,"click"],[1,"fas","fa-plus","fontawsome-icon",2,"font-size","12px"],["class","btn btn-add-users","ngbTooltip","Add Host Address","routerLink","/jrm/scan-files-details/hosts-config/list",4,"ngIf"],[1,"content-report","m-b-2"],[1,"content-reportlist"],[1,"accordion"],[1,"card"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["ngbTooltip","Add Host Address","routerLink","/jrm/scan-files-details/hosts-config/list",1,"btn","btn-add-users"],["src","assets/images/icons/settings.png","routerLink","/jrm/scan-files-details/hosts-config/list",1,"icons_default_size"],[1,"card-header","d-flex","justify-content-between","align-items-center",2,"cursor","pointer","padding","5px",3,"click"],[1,"align-items-center","d-flex",3,"click"],[1,"reportname"],[1,"reportname","m-1"],["src","assets/images/icons/export-icon.svg","ngbTooltip"," Export Excel",2,"width","18px",3,"click"],[3,"ngClass"],["class","table-responsive table table-theme table-row v-middle","style","margin: 0px 24px; width: 96%;",4,"ngIf"],[1,"table-responsive","table","table-theme","table-row","v-middle",2,"margin","0px 24px","width","96%"],[4,"ngIf"],["colspan","4"],[2,"text-transform","capitalize"],[2,"white-space","normal"],[1,"row"],[1,"col-md-2","col-lg-2","col-sm-12","col-xs-12",2,"width","max-width"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","pageLength",1,"floating-label"],[1,"col-md-3","col-lg-3","col-sm-12","col-xs-12"],["for","totalResult",1,"floating-label"],[1,"col-md-7","col-lg-7","col-sm-12","col-xs-12"],[3,"pageChange","collectionSize","page","pageSize"],[3,"value"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"info-row"],[1,"label"],[1,"colon"],[1,"value"],[1,"chips-container"],["class","custom-chip",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-center"],["type","button",1,"btn-danger","btn-sm",2,"padding","5px","background-color","red",3,"click"],[1,"custom-chip"]],template:function(s,i){if(1&s){const a=e.RV6();e.j41(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7)(7,"input",8),e.mxI("ngModelChange",function(m){return e.eBV(a),e.DH7(i.searchText,m)||(i.searchText=m),e.Njj(m)}),e.bIt("keyup",function(){return e.eBV(a),e.Njj(i.searchMatchedData())}),e.k0s(),e.j41(8,"label",9),e.EFF(9,"Search"),e.k0s(),e.j41(10,"div",10),e.nrm(11,"i",11),e.k0s()()()(),e.j41(12,"div",12)(13,"button",13),e.bIt("click",function(){return e.eBV(a),e.Njj(i.reset())}),e.nrm(14,"img",14),e.k0s(),e.j41(15,"button",15),e.bIt("click",function(){return e.eBV(a),e.Njj(i.scanFiles())}),e.nrm(16,"i",16),e.EFF(17," Scan Files "),e.k0s(),e.DNE(18,T,2,0,"button",17),e.k0s()(),e.j41(19,"div",18),e.nrm(20,"hr"),e.j41(21,"div",19)(22,"div",20)(23,"div",21),e.DNE(24,L,14,8,"div",22),e.nI1(25,"deepFilter"),e.DNE(26,V,18,6,"div",23),e.k0s()()()()()()(),e.DNE(27,G,44,8,"ng-template",null,0,e.C5r)}2&s&&(e.R7$(7),e.R50("ngModel",i.searchText),e.R7$(4),e.Y8G("autoClose","outside"),e.R7$(7),e.Y8G("ngIf",!i.Is_EMPLOYEE),e.R7$(6),e.Y8G("ngForOf",e.i5U(25,5,i.scanDataList,i.searchText)),e.R7$(2),e.Y8G("ngIf",(null==i.paginationResponseData?null:i.paginationResponseData.response)&&(null==i.scanDataList?null:i.scanDataList.length)))},dependencies:[F.G,E.B,h.YU,h.Sq,h.bT,u.Wk,o.xH,o.y7,o.me,o.wz,o.BC,o.YS,o.vS,c.ZM,c.md,C.j,P.V,h.vh]})}}return n})();var q=r(3075),M=r(3482);const B=()=>({standalone:!0});function X(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),e.nrm(4,"img",15),e.j41(5,"span",16),e.EFF(6,"General"),e.k0s()()(),e.j41(7,"div",17)(8,"div",18)(9,"div",19)(10,"div",20),e.nrm(11,"input",21),e.j41(12,"label",22),e.EFF(13,"Target Name"),e.k0s(),e.j41(14,"small",23),e.EFF(15),e.k0s()()()(),e.j41(16,"div",18)(17,"div",19)(18,"div",20),e.nrm(19,"angular2-multiselect",24),e.j41(20,"label",25),e.EFF(21,"Pii Types"),e.k0s(),e.j41(22,"small",23),e.EFF(23),e.k0s()()()()()()(),e.j41(24,"div")(25,"div",26)(26,"div",27)(27,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("next"))}),e.EFF(28,"Next"),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(15),e.JRh(t.getErrorMessage("targetName","Target Name")),e.R7$(4),e.Y8G("settings",t.dropdownSettings)("data",t.piiPatternDropdown)("disabled",t.isEdit),e.R7$(4),e.JRh(t.getErrorMessage("piiTypes","PiiTypes"))}}function O(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.prevPage())}),e.EFF(1,"\xab"),e.k0s()}}function z(n,l){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",44)(2,"input",45),e.bIt("change",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onHostCheckboxChange(i))}),e.k0s(),e.j41(3,"label",46),e.EFF(4),e.k0s()(),e.bVm()}if(2&n){const t=l.$implicit,s=e.XpG(2);e.R7$(2),e.Y8G("id","host_"+t.id)("value",t.ip)("checked",s.configuredHosts.includes(t.ip)),e.R7$(),e.Y8G("for","host_"+t.id),e.R7$(),e.SpI(" ",t.name," ")}}function Y(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.nextPage())}),e.EFF(1," \xbb "),e.k0s()}}function H(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",17)(1,"div",34)(2,"label",47),e.EFF(3," Enter IP addresses (one per line) "),e.k0s(),e.j41(4,"textarea",48),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.manualIpList,i)||(a.manualIpList=i),e.Njj(i)}),e.k0s(),e.j41(5,"div",49),e.EFF(6,"Only valid IPv4 addresses will be accepted. "),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(4),e.R50("ngModel",t.manualIpList),e.Y8G("ngModelOptions",e.lJ4(2,B))}}function U(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",29)(1,"div",12)(2,"div",30),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onServerTypeChange("configured"))}),e.j41(3,"div",31)(4,"input",32),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onServerTypeChange("configured"))}),e.k0s()(),e.j41(5,"div",14),e.nrm(6,"img",15),e.j41(7,"span",33),e.EFF(8,"Configured Servers"),e.k0s()()(),e.j41(9,"div",17)(10,"div",34)(11,"span",35),e.EFF(12,"Scan Servers"),e.k0s(),e.nrm(13,"hr",36),e.j41(14,"div",37),e.DNE(15,O,2,0,"button",38)(16,z,5,5,"ng-container",39)(17,Y,2,0,"button",38),e.k0s()()()()(),e.j41(18,"div",11)(19,"div",12)(20,"div",30),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onServerTypeChange("non-configured"))}),e.j41(21,"div",31)(22,"input",40),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onServerTypeChange("non-configured"))}),e.k0s()(),e.j41(23,"div",14),e.nrm(24,"img",15),e.j41(25,"span",33),e.EFF(26,"Non-Configured Server"),e.k0s()()(),e.DNE(27,H,7,3,"div",41),e.k0s()(),e.j41(28,"div")(29,"div",26)(30,"div",27)(31,"button",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("prev"))}),e.EFF(32,"Prev"),e.k0s(),e.j41(33,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("next"))}),e.EFF(34,"Next"),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("checked","configured"===t.selectedServerType),e.R7$(11),e.Y8G("ngIf",t.currentPage>1),e.R7$(),e.Y8G("ngForOf",t.paginatedHosts),e.R7$(),e.Y8G("ngIf",t.currentPage*t.pageSize<t.hostsList.length),e.R7$(5),e.Y8G("checked","non-configured"===t.selectedServerType),e.R7$(5),e.Y8G("ngIf","non-configured"===t.selectedServerType)}}function J(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),e.nrm(4,"img",15),e.j41(5,"span",16),e.EFF(6,"User Details"),e.k0s()()(),e.j41(7,"div",17)(8,"div",18)(9,"div",19)(10,"div",20),e.nrm(11,"input",50),e.j41(12,"label",51),e.EFF(13,"Name"),e.k0s(),e.j41(14,"small",23),e.EFF(15),e.k0s()()()(),e.j41(16,"div",18)(17,"div",19)(18,"div",20),e.nrm(19,"input",52),e.j41(20,"label",53),e.EFF(21,"Password"),e.k0s(),e.j41(22,"small",23),e.EFF(23),e.k0s()()()(),e.j41(24,"div",18)(25,"div",19)(26,"div",20),e.nrm(27,"input",54),e.j41(28,"label",55),e.EFF(29,"Confirm Password"),e.k0s(),e.j41(30,"small",23),e.EFF(31),e.k0s()()()()()()(),e.j41(32,"div",11)(33,"div",12)(34,"div",13)(35,"div",14),e.nrm(36,"img",15),e.j41(37,"span",16),e.EFF(38,"Content Roots (File Path)"),e.k0s()()(),e.j41(39,"div",17)(40,"div",18)(41,"div",19)(42,"div",20),e.nrm(43,"input",56),e.j41(44,"label",57),e.EFF(45,"File Path"),e.k0s(),e.j41(46,"small",23),e.EFF(47),e.k0s()()()()()()(),e.j41(48,"div")(49,"div",26)(50,"div",27)(51,"button",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("prev"))}),e.EFF(52,"Prev"),e.k0s(),e.j41(53,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("next"))}),e.EFF(54,"Next"),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(15),e.JRh(t.getErrorMessage("username","Name")),e.R7$(8),e.JRh(t.getErrorMessage("password","Password")),e.R7$(8),e.JRh(t.getErrorMessage("conPassword","Confirm Password")),e.R7$(16),e.JRh(t.getErrorMessage("filePath","File Path"))}}function K(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),e.nrm(4,"img",15),e.j41(5,"span",16),e.EFF(6,"Filters"),e.k0s()()(),e.j41(7,"div",17)(8,"div",18)(9,"div",19)(10,"div",20),e.nrm(11,"textarea",58),e.j41(12,"label",59),e.EFF(13,"Exclude Patterns"),e.k0s(),e.j41(14,"small",23),e.EFF(15),e.k0s()()()()()()(),e.j41(16,"div")(17,"div",26)(18,"div",27)(19,"button",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("prev"))}),e.EFF(20,"Prev"),e.k0s(),e.j41(21,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("next"))}),e.EFF(22,"Next"),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(15),e.SpI(" ",t.getErrorMessage("excludePatterns","Exclude Patterns")," ")}}function Q(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),e.nrm(4,"img",15),e.j41(5,"span",16),e.EFF(6,"Inventory Scanning"),e.k0s()()(),e.j41(7,"div",17)(8,"div",18)(9,"div",19)(10,"div",20),e.nrm(11,"input",60),e.j41(12,"label",61),e.EFF(13,"Max File Size"),e.k0s(),e.j41(14,"small",23),e.EFF(15),e.k0s()()()(),e.j41(16,"div",18)(17,"div",19)(18,"div",20),e.nrm(19,"input",62),e.j41(20,"label",63),e.EFF(21,"Stop Scanning After no. Incidents"),e.k0s(),e.j41(22,"small",23),e.EFF(23),e.k0s()()()()()()(),e.j41(24,"div")(25,"div",26)(26,"div",27)(27,"button",64),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeTab("prev"))}),e.EFF(28,"Prev"),e.k0s(),e.j41(29,"button",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(30,"Cancel"),e.k0s(),e.j41(31,"button",66),e.EFF(32,"Submit"),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(15),e.JRh(t.getErrorMessage("maxFileSize","Max File Size")),e.R7$(8),e.JRh(t.getErrorMessage("stopScannAfter","no. Incidents Required"))}}const W=[{path:"",component:_,children:[{path:"",redirectTo:"files_list",pathMatch:"full"},{path:"files_list",component:$},{path:"files_scan",component:(()=>{class n{constructor(t,s,i,a,d,m,ee,te){this.router=t,this.fb=s,this.globalService=i,this.spinner=a,this.modalService=d,this.filesScanService=m,this.hostsService=ee,this.cdr=te,this.dropdownSettings={},this.piiPatternDropdown=[],this.boxVisibility=!0,this.active=1,this.configuredHosts=[],this.nonConfiguredHosts=[],this.pageSize=4,this.currentPage=1,this.selectedServerType="configured",this.manualIpList="",this.isLoading=!1,this.showError=!1,this.errorMsg="",this.destroy$=new v.B,this.isEdit=!1,this.idToEdit=0,this.hostsList=[],this.remotePiiScanRequestForm=new o.gE({}),this.remotePiiScanRequestObj={},this.piiPatternDropdown=[{id:1,itemName:"pan"},{id:2,itemName:"aadhaar"},{id:3,itemName:"gstin"},{id:4,itemName:"voter"},{id:5,itemName:"dl"},{id:6,itemName:"passport"},{id:7,itemName:"ifsc"},{id:8,itemName:"micr"},{id:9,itemName:"account_number"},{id:10,itemName:"cif_number"},{id:11,itemName:"debit_card"},{id:12,itemName:"credit_card"},{id:13,itemName:"upi_id"},{id:14,itemName:"ckyc"},{id:15,itemName:"loan_account"},{id:16,itemName:"fd_account"},{id:17,itemName:"swift_code"},{id:18,itemName:"employee_id"},{id:19,itemName:"customer_id"},{id:20,itemName:"transaction_ref"},{id:21,itemName:"demat_account"},{id:22,itemName:"email"},{id:23,itemName:"phone"},{id:24,itemName:"vehicle_number"}]}ngOnInit(){this.dropdownSettings={singleSelection:!1,primaryKey:"id",labelKey:"itemName",text:"Select Pii Types",selectAllText:"Select All",unSelectAllText:"UnSelect All",disabled:this.isEdit,itemsShowLimit:5,defaultOpen:!1,enableSearchFilter:!0,noDataAvailablePlaceholderText:"There is no item availabale to show"},this.buildForm(),this.remotePiiScanRequestForm.get("password")?.valueChanges.subscribe(()=>{this.remotePiiScanRequestForm.updateValueAndValidity()}),this.remotePiiScanRequestForm.get("conPassword")?.valueChanges.subscribe(()=>{this.remotePiiScanRequestForm.updateValueAndValidity()}),this.getAllActieHostList()}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}cancel(){this.router.navigate(["/jrm/scan-files-details/files_list"])}toggleBox(){this.boxVisibility=!this.boxVisibility}buildForm(){this.remotePiiScanRequestForm=this.fb.group({maxFileSize:[this.remotePiiScanRequestObj.maxFileSize,[o.k0.required,o.k0.minLength(2)]],targetName:[this.remotePiiScanRequestObj.targetName,[o.k0.required,o.k0.minLength(2)]],filePath:[this.remotePiiScanRequestObj.filePath,[o.k0.required,o.k0.minLength(1)]],piiTypes:[this.remotePiiScanRequestObj.piiTypes,[o.k0.minLength(2)]],excludePatterns:[this.remotePiiScanRequestObj.excludePatterns,[o.k0.minLength(2)]],stopScannAfter:[this.remotePiiScanRequestObj.stopScannAfter],host:[this.remotePiiScanRequestObj?.connection?.host??[],[o.k0.required]],port:[this.remotePiiScanRequestObj?.connection?.port??22,[o.k0.required,o.k0.min(1)]],username:[this.remotePiiScanRequestObj?.connection?.username??"",[o.k0.required]],password:[this.remotePiiScanRequestObj?.connection?.password??"",[o.k0.required]],conPassword:[this.remotePiiScanRequestObj?.connection?.conPassword??"",[o.k0.required]]},{validators:this.passwordMatchValidator.bind(this)})}passwordMatchValidator(t){const s=t.get("password")?.value,i=t.get("conPassword")?.value;if(s!==i)t.get("conPassword")?.setErrors({passwordMismatch:!0});else{const a=t.get("conPassword")?.errors;a&&a.passwordMismatch&&(delete a.passwordMismatch,0===Object.keys(a).length?t.get("conPassword")?.setErrors(null):t.get("conPassword")?.setErrors(a))}return null}getErrorMessage(t,s){return this.globalService.getErrorMessage(this.remotePiiScanRequestForm,t,s)}changeTab(t){"next"===t&&this.active<5?this.active++:"prev"===t&&this.active>1&&this.active--}getAllActieHostList(){this.isLoading=!0,this.spinner.start(),this.hostsService.getAllActiveHostsList().pipe((0,p.Q)(this.destroy$),(0,g.j)(()=>{this.isLoading=!1,this.spinner.stop()})).subscribe({next:t=>{this.hostsList=t,this.cdr.detectChanges()},error:t=>console.error(t),complete:()=>console.info("complete")})}onHostCheckboxChange(t){const s=t.target.value;t.target.checked?this.configuredHosts.includes(s)||this.configuredHosts.push(s):this.configuredHosts=this.configuredHosts.filter(a=>a!==s);const i=this.remotePiiScanRequestForm.get("host");i&&(i.setValue(this.configuredHosts),i.markAsTouched(),i.updateValueAndValidity())}onServerTypeChange(t){this.selectedServerType=t,"configured"===t?(this.manualIpList="",this.remotePiiScanRequestForm.contains("manualIps")&&this.remotePiiScanRequestForm.removeControl("manualIps"),this.remotePiiScanRequestForm.contains("host")||this.remotePiiScanRequestForm.addControl("host",new o.MJ([],o.k0.required)),this.configuredHosts=[],this.remotePiiScanRequestForm.get("host")?.setValue([])):(this.configuredHosts=[],this.remotePiiScanRequestForm.contains("host")&&this.remotePiiScanRequestForm.removeControl("host"),this.remotePiiScanRequestForm.contains("manualIps")||this.remotePiiScanRequestForm.addControl("manualIps",new o.MJ("",o.k0.required)),this.remotePiiScanRequestForm.get("manualIps")?.setValue(this.manualIpList))}get paginatedHosts(){const t=(this.currentPage-1)*this.pageSize;return this.hostsList.slice(t,t+this.pageSize)}nextPage(){this.currentPage*this.pageSize<this.hostsList.length&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}isValidIp(t){return/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/.test(t)}getManualIps(){return this.manualIpList.split("\n").map(t=>t.trim()).filter(t=>t&&this.isValidIp(t))}submit(){if(this.showError=!1,this.remotePiiScanRequestObj={},this.errorMsg="","configured"===this.selectedServerType&&!this.remotePiiScanRequestForm.valid)return void this.globalService.showAlert("Error","Please enter all mandatory fields!");if("non-configured"===this.selectedServerType&&0===this.getManualIps().length)return void this.globalService.showAlert("Error","Please enter at least one valid IP address!");const t=this.remotePiiScanRequestForm.value;this.remotePiiScanRequestObj={targetName:t.targetName,maxFileSize:t.maxFileSize,stopScannAfter:t.stopScannAfter,filePath:t.filePath,piiTypes:(t.piiTypes||[]).map(s=>s.itemName),excludePatterns:t.excludePatterns,connection:{host:"configured"===this.selectedServerType?t.host:this.getManualIps(),port:t.port||22,username:t.username,password:t.password}},this.isLoading=!0,this.spinner.start(),this.filesScanService.addRemoteScanData(this.remotePiiScanRequestObj).pipe((0,p.Q)(this.destroy$),(0,g.j)(()=>{this.isLoading=!1,this.spinner.stop()})).subscribe({next:()=>{this.globalService.showAlert("success","Successfully Submitted!"),this.router.navigate(["/jrm/scan-files-details/files_list"])},error:s=>{let i;409==s.error.errorCode?(i=s.error.errorMessage,this.globalService.showAlert("error",i)):"INVALID_PATH"==s.error.errorCode?(i=s.error.errorMessage,this.globalService.showAlert("error",i),this.router.navigate(["/jrm/scan-files-details/files_list"])):500==s.status&&(i=s.error.errorMessage,this.globalService.showAlert("error",i))}})}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(u.Ix),e.rXU(o.ok),e.rXU(b.d),e.rXU(j.eD),e.rXU(c.Bq),e.rXU(S),e.rXU(q.F),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-scan-files-details-add"]],standalone:!0,features:[e.aNF],decls:28,vars:8,consts:[["nav","ngbNav"],[1,"content-report"],[1,"container-bg"],[1,"card"],[1,"card-body-inner","pt-0"],[3,"ngSubmit","formGroup"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[1,"content-reportlist"],[1,"card","inner-card"],[1,"card-header","d-flex","justify-content-between","align-items-center",2,"cursor","pointer","padding","5px"],[1,"showCursor","d-flex","align-items-center"],["src","assets/images/icons/arrow-down-fill.svg","alt","arrow"],[1,"reportname"],[1,"according-inner-body"],[1,"row"],[1,"col-md-6","col-lg-6","col-sm-6","col-xs-6"],[1,"floating-label-group"],["id","targetName","type","text","formControlName","targetName","placeholder"," ",1,"form-control"],["for","targetName",1,"floating-label","required"],[1,"errormessage"],["formControlName","piiTypes",2,"font-size","small",3,"settings","data","disabled"],["for","piiTypes",1,"floating-label-multiselect"],[1,"row","m-b-10"],[1,"col-md-12","text-right"],["type","button",1,"btn-submit-all",3,"click"],[1,"content-reportlist","mb-3"],[1,"card-header","d-flex","justify-content-start","align-items-center",2,"cursor","pointer","padding","5px",3,"click"],[1,"me-3"],["type","radio","value","configured",3,"change","checked"],[1,"reportname","ms-2"],[1,"m-3"],[1,"sub-name"],[2,"width","90%"],[1,"d-flex","align-items-center","gap-3","mt-3"],["class","nav-arrow-btn",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["type","radio","value","non-configured",3,"change","checked"],["class","according-inner-body",4,"ngIf"],["type","button",1,"btn-closed",3,"click"],[1,"nav-arrow-btn",3,"click"],[1,"form-check","d-flex","align-items-center"],["type","checkbox",1,"form-check-input",3,"change","id","value","checked"],[1,"label","ms-2","mb-0",3,"for"],["for","manualIps",1,"form-label","sub-name"],["id","manualIps","rows","5","placeholder","e.g. 192.168.1.10\n10.0.0.1","cols","6",1,"form-control","custom-textarea",3,"ngModelChange","ngModel","ngModelOptions"],[1,"text-muted","mt-1","sub-name"],["id","username","type","text","formControlName","username","placeholder"," ",1,"form-control"],["for","username",1,"floating-label","required"],["id","password","type","password","formControlName","password","placeholder"," ",1,"form-control"],["for","password",1,"floating-label","required"],["id","conPassword","type","password","formControlName","conPassword","placeholder"," ",1,"form-control"],["for","conPassword",1,"floating-label","required"],["id","filePath","type","text","formControlName","filePath","placeholder"," ",1,"form-control"],["for","filePath",1,"floating-label","required"],["id","excludePatterns","formControlName","excludePatterns","placeholder"," ","cols","6",1,"form-control","custom-textarea"],["for","excludePatterns",1,"floating-label"],["id","maxFileSize","type","number","formControlName","maxFileSize","placeholder"," ",1,"form-control"],["for","maxFileSize",1,"floating-label","required"],["id","stopScannAfter","type","number","formControlName","stopScannAfter","placeholder"," ",1,"form-control"],["for","stopScannAfter",1,"floating-label","required"],["type","button",1,"btn-closed","mx-2",3,"click"],["type","reset",1,"btn-closed",3,"click"],["type","submit",1,"btn-submit-all"]],template:function(s,i){if(1&s){const a=e.RV6();e.j41(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"form",5),e.bIt("ngSubmit",function(){return e.eBV(a),e.Njj(i.submit())}),e.j41(5,"ul",6,0),e.mxI("activeIdChange",function(m){return e.eBV(a),e.DH7(i.active,m)||(i.active=m),e.Njj(m)}),e.j41(7,"li",7)(8,"a",8),e.EFF(9,"General"),e.k0s(),e.DNE(10,X,29,5,"ng-template",9),e.k0s(),e.j41(11,"li",7)(12,"a",8),e.EFF(13,"Targeting"),e.k0s(),e.DNE(14,U,35,6,"ng-template",9),e.k0s(),e.j41(15,"li",7)(16,"a",8),e.EFF(17,"Scanning Content"),e.k0s(),e.DNE(18,J,55,4,"ng-template",9),e.k0s(),e.j41(19,"li",7)(20,"a",8),e.EFF(21,"Fillters"),e.k0s(),e.DNE(22,K,23,1,"ng-template",9),e.k0s(),e.j41(23,"li",7)(24,"a",8),e.EFF(25,"Advanced"),e.k0s(),e.DNE(26,Q,33,2,"ng-template",9),e.k0s()(),e.nrm(27,"div",10),e.k0s()()()()()}if(2&s){const a=e.sdS(6);e.R7$(4),e.Y8G("formGroup",i.remotePiiScanRequestForm),e.R7$(),e.R50("activeId",i.active),e.R7$(2),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavItem",3),e.R7$(4),e.Y8G("ngbNavItem",4),e.R7$(4),e.Y8G("ngbNavItem",5),e.R7$(4),e.Y8G("ngbNavOutlet",a)}},dependencies:[F.G,c.Um,c.X9,c.sy,c.Ri,c.m_,h.Sq,h.bT,o.qT,o.me,o.Q0,o.BC,o.cb,o.vS,o.j4,o.JD,M.Cr]})}}return n})()},{path:"hosts-config",loadChildren:()=>Promise.all([r.e(76),r.e(316)]).then(r.bind(r,316)).then(n=>n.HostsRoutingModule)}]}];let Z=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[u.iI.forChild(W),u.iI]})}}return n})()}}]);